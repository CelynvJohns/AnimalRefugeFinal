@model AnimalRefugeFinal.Models.AdoptionApplication

@{
    ViewData["Title"] = "Adoption Application";
}

<style>
    form {
        max-width: 400px;
        margin: auto;
    }

    div {
        margin-bottom: 15px;
    }

    label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
    }

    input,
    textarea {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
    }

    button {
        background-color: #4CAF50;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

        button:hover {
            background-color: #45a049;
        }
</style>

<h2 style="text-align: center;">@ViewData["Title"]</h2>

<form asp-action="Apply" method="post">

    @if (User.Identity.IsAuthenticated)
    {
        <input type="hidden" asp-for="User" value="@User.Identity.Name" />
    }

    <div>
        <label asp-for="FirstName">First Name:</label>
        <input asp-for="FirstName" />
    </div>
    <div>
        <label asp-for="LastName">Last Name:</label>
        <input asp-for="LastName" />
    </div>

    <div>
        <label asp-for="Email">Email:</label>
        <input asp-for="Email" />
    </div>

    <div>
        <label asp-for="PhoneNumber">Phone Number:</label>
        <input asp-for="PhoneNumber" />
    </div>

    <div>
        <label asp-for="Address">Address:</label>
        <textarea asp-for="Address"></textarea>
    </div>

    <div>
        <label asp-for="Reason">Reson for wanting to adopt:</label>
        <textarea asp-for="Reason"></textarea>
    </div>

    <div>
        <label asp-for="WantsToAdoptDog">Do you want to adopt a dog?</label>
        <input asp-for="WantsToAdoptDog" type="checkbox" />
    </div>

    <div>
        <label asp-for="HasFencedInYard">Do you have a fenced-in yard?</label>
        <input asp-for="HasFencedInYard" type="checkbox" />
    </div>

    <div>
        <label asp-for="NumberOfPets">Number of Pets You are looking to Adopt:</label>
        <input asp-for="NumberOfPets" type="number" min="1" id="numberOfPets" />
    </div>
    <!-- STILL NEED TO FIGURE OUT HOW TO MAKE THIS WORK, PROBABLY WILL NEED TO USE SESSIONS-->
    @for (int i = 1; i <= Model.NumberOfPets; i++)
    {
        <div class="petContainer">
            <label asp-for="Pets[i].Name">Pet Name @i:</label>
            <input asp-for="Pets[i].Name" />
        </div>
    }

    <div>
        <label asp-for="CurrentPetNumber">Current Pets you have at Home:</label>
        <input asp-for="CurrentPetNumber" type="number" id="CurrentPetNumber" />
    </div>

    @for (int i = 1; i <= Model.CurrentPetNumber; i++)
    {
        <div class="currentPetContainer">
            <label asp-for="CurrentPet[i].CurrentPetName"> Current Pet Name @i:</label>
            <input asp-for="CurrentPet[i].CurrentPetName" />
            <label asp-for="CurrentPet[i].CurrentPetAge">Current Pet Age @i:</label>
            <input asp-for="CurrentPet[i].CurrentPetAge" />
            <label asp-for="CurrentPet[i].CurrentPetBreed">Current Pet Breed @i:</label>
            <input asp-for="CurrentPet[i].CurrentPetBreed" />
            <label asp-for="CurrentPet[i].VetName">Current Vet @i:</label>
            <input asp-for="CurrentPet[i].VetName" />
            <label asp-for="CurrentPet[i].VetPhoneNumber">Current Vet Phone Number @i:</label>
            <input asp-for="CurrentPet[i].VetPhoneNumber" />
        </div>
    }

    <div>
        <label asp-for="CurrentHumansNumber">Current number of Family members in your House:</label>
        <input asp-for="CurrentHumansNumber" type="number" id="CurrentHumansNumber" />
    </div>

    @for (int i = 1; i <= Model.CurrentHumansNumber; i++)
    {
        <div class="currentHumanContainer">
            <label asp-for="CurrentHumans[i].FirstName"> Family member First Name @i:</label>
            <input asp-for="CurrentHumans[i].FirstName" />
            <label asp-for="CurrentHumans[i].LastName"> Family member Last Name @i:</label>
            <input asp-for="CurrentHumans[i].LastName" />
            <label asp-for="CurrentHumans[i].Age"> Family member Age @i:</label>
            <input asp-for="CurrentHumans[i].Age" />
        </div>
    }

    <div>
        <button type="submit">Submit Application</button>
    </div>
</form>
@section scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Function to update fields based on the number entered
            function updateFields(inputId, containerId, fieldLabel, fieldName) {
                var input = document.getElementById(inputId);
                var container = document.getElementById(containerId);

                input.addEventListener("change", function () {
                    updateFieldsContent();
                });

                function updateFieldsContent() {
                    var number = parseInt(input.value, 10);

                    // Clear existing fields
                    container.innerHTML = "";

                    // Add new fields based on the number entered
                    for (var i = 0; i < number; i++) {
                        var fieldContainer = document.createElement("div");
                        fieldContainer.classList.add(containerId);

                        var fieldLabelElement = document.createElement("label");
                        fieldLabelElement.innerText = fieldLabel + " " + (i + 1) + ":";
                        fieldContainer.appendChild(fieldLabelElement);

                        var fieldInput = document.createElement("input");
                        fieldInput.setAttribute("name", fieldName.replace("[i]", "[" + i + "]"));
                        fieldContainer.appendChild(fieldInput);

                        container.appendChild(fieldContainer);
                    }
                }

                // Initial update
                updateFieldsContent();
            }

            // Update fields for CurrentPets
            updateFields("CurrentPetNumber", "CurrentPetContainer", "Current Pet", "CurrentPet[i].");

            // Update fields for CurrentHumans
            updateFields("CurrentHumansNumber", "currentHumanContainer", "Family member", "CurrentHumans[i].");
        });
    </script>

}